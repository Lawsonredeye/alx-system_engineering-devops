#!/usr/bin/env bash
# script to configure HAProxy for server

# Install HAProxy
sudo apt-get install --no-install-recommends software-properties-common
sudo add-apt-repository ppa:vbernat/haproxy-2.9
sudo apt-get install haproxy=2.9.\*

# pass the frontend and backend settings to the /etc/haproxy .cfg file
sudo echo "     
frontend http_server
        bind *:80
        default_backend http_runner

backend http_runner
        balance roundrobin
        server 516971-web-01 52.86.247.182:80 check
        server 516971-web-02 52.91.128.2:80 check
" >> /etc/haproxy/haproxy.cfg

# start haproxy
sudo service haproxy restart